import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.B-XtCDNB.js";const g=JSON.parse('{"title":"Ubuntu Jetson上的定时任务","description":"","frontmatter":{"title":"Ubuntu Jetson上的定时任务","date":"2025-01-01T00:00:00.000Z","categories":["Ubuntu"],"tags":["Jetson","定时任务"]},"headers":[],"relativePath":"posts/Ubuntu/ubuntu-jetson上的定时任务.md","filePath":"posts/Ubuntu/ubuntu-jetson上的定时任务.md"}'),t={name:"posts/Ubuntu/ubuntu-jetson上的定时任务.md"};function h(p,s,e,k,d,r){return n(),a("div",null,[...s[0]||(s[0]=[l(`<h1 id="使用-crontab-制定定时任务" tabindex="-1">使用 crontab 制定定时任务 <a class="header-anchor" href="#使用-crontab-制定定时任务" aria-label="Permalink to &quot;使用 crontab 制定定时任务&quot;">​</a></h1><h2 id="目标" tabindex="-1">目标 <a class="header-anchor" href="#目标" aria-label="Permalink to &quot;目标&quot;">​</a></h2><ol><li>每分钟清理当前分钟之前的图片。 [可选]</li><li>每小时清理当前小时之前的图片。 [可选]</li><li>每天清理当前日期之前的图片。 [可选]</li></ol><h2 id="环境" tabindex="-1">环境 <a class="header-anchor" href="#环境" aria-label="Permalink to &quot;环境&quot;">​</a></h2><ul><li>操作系统：Ubuntu 22.04 (jetson)</li><li>需要清理的文件夹：<code>/home/nvidia/install/Snapshot</code></li></ul><h2 id="步骤" tabindex="-1">步骤 <a class="header-anchor" href="#步骤" aria-label="Permalink to &quot;步骤&quot;">​</a></h2><h3 id="_1-编写清理脚本" tabindex="-1">1. 编写清理脚本 <a class="header-anchor" href="#_1-编写清理脚本" aria-label="Permalink to &quot;1. 编写清理脚本&quot;">​</a></h3><ol><li><p><strong>创建清理脚本</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gedit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/cleanup_images.sh</span></span></code></pre></div></li><li><p><strong>编辑脚本</strong>，输入以下内容：(可选就是选择其中一个,不需要的注释起来)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置日志文件路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG_FILE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/home/nvidia/install/cleanup_images.log&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取当前日期和时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CURRENT_DATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%Y-%m-%d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CURRENT_HOUR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%H</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CURRENT_MINUTE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%M</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每分钟清理当前分钟之前的图片 [可选]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/Snapshot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;*.jpg&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -mmin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">): Cleaned up images older than </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$CURRENT_DATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $CURRENT_HOUR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$CURRENT_MINUTE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> (minute)&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每小时清理当前小时之前的图片 [可选]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/Snapshot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;*.jpg&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -mmin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +60</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">): Cleaned up images older than </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$CURRENT_DATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $CURRENT_HOUR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:00 (hour)&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $LOG_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每天清理当前日期之前的图片  [可选]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/Snapshot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;*.jpg&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -mtime</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">): Cleaned up images older than </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$CURRENT_DATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:00 (day)&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $LOG_FILE</span></span></code></pre></div></li><li><p><strong>保存并关闭编辑器</strong></p></li><li><p><strong>使脚本可执行</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/cleanup_images.sh</span></span></code></pre></div></li></ol><h3 id="_2-编辑-crontab-文件" tabindex="-1">2. 编辑 <code>crontab</code> 文件 <a class="header-anchor" href="#_2-编辑-crontab-文件" aria-label="Permalink to &quot;2. 编辑 \`crontab\` 文件&quot;">​</a></h3><ol><li><p><strong>使用 <code>vim</code> 编辑 <code>crontab</code> 文件</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EDITOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">vim</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> crontab</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span></span></code></pre></div></li><li><p><strong>添加多种清理任务</strong>： (可选就是选择其中一个,不需要的注释起来)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每分钟清理当前分钟之前的图片  [可选]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /home/nvidia/install/cleanup_images.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每小时清理当前小时之前的图片  [可选]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/cleanup_images.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 每天清理当前日期之前的图片   [可选]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/cleanup_images.sh</span></span></code></pre></div></li><li><p><strong>保存并退出</strong>：</p><ul><li>按 <code>Esc</code> 键进入命令模式。</li><li>输入 <code>:wq</code> 保存并退出。</li></ul></li></ol><h3 id="_3-验证-cron-任务" tabindex="-1">3. 验证 <code>cron</code> 任务 <a class="header-anchor" href="#_3-验证-cron-任务" aria-label="Permalink to &quot;3. 验证 \`cron\` 任务&quot;">​</a></h3><ol><li><p><strong>检查 <code>cron</code> 任务是否已添加</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crontab</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span></span></code></pre></div><p>你应该能看到类似以下的输出：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>* * * * * /home/nvidia/install/cleanup_images.sh</span></span>
<span class="line"><span>0 * * * * /home/nvidia/install/cleanup_images.sh</span></span>
<span class="line"><span>0 0 * * * /home/nvidia/install/cleanup_images.sh</span></span></code></pre></div></li><li><p><strong>检查 <code>cron</code> 日志</strong>，确保定时任务已成功执行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/cleanup_images.log</span></span></code></pre></div><p><strong>预期输出</strong>：</p><ul><li>你应该能看到 <code>cron</code> 任务的执行日志。</li></ul></li><li><p><strong>检查清理日志</strong>，确保脚本已成功执行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/nvidia/install/cleanup_images.log</span></span></code></pre></div><p><strong>预期输出</strong>：</p><ul><li>你应该能看到类似以下的记录：<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>2024-11-19 15:01:00: Cleaned up images older than 2024-11-19 15:00 (minute)</span></span>
<span class="line"><span>2024-11-19 15:00:00: Cleaned up images older than 2024-11-19 14:00 (hour)</span></span>
<span class="line"><span>2024-11-19 00:00:00: Cleaned up images older than 2024-11-18 00:00 (day)</span></span></code></pre></div></li></ul></li></ol>`,12)])])}const F=i(t,[["render",h]]);export{g as __pageData,F as default};
